namespace SQLGen
{
    public partial class Form1 : Form
    {
        Boolean instnum = false;
        Boolean batchnum = false;

        public Form1()
        {
            InitializeComponent();
        }

        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        private void checkBox1_CheckedChanged(object sender, EventArgs e)
        {
            instnum = checkBox1.Checked;
        }

        private void checkBox2_CheckedChanged(object sender, EventArgs e)
        {
            batchnum = checkBox2.Checked;
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            richTextBox1.Text = GenerateStatement();
            label1.Text = GenerateStatement();
        }

        private void label1_Click(object sender, EventArgs e)
        {

        }
        private String GenerateStatement()
        {
            String table;
            String key;
            String output;

            table = comboBox1.Text;
            key = textBox1.Text;

            if (table.Equals("Transactions") && instnum)
            {
                output = "SELECT * FROM TBL_Transactions WHERE InstNum = '" + key + "';";
                output += "\nSELECT * FROM TBL_CashJournal WHERE InstNum = '" + key + "';";
                output += "\nSELECT * FROM TBL_CJMoney WHERE BatchNum = ' ';";
                output += "\nSELECT * FROM TBL_ARtrans WHERE BatchNum = ' ';";
                return output;
            }
            else if(table.Equals("Transactions") && batchnum)
            {
                output = "SELECT * FROM TBL_Transactions WHERE BatchNum = '" + key + "';";
                output += "\nSELECT * FROM TBL_CashJournal WHERE BatchNum = '" + key + "';";
                output += "\nSELECT * FROM TBL_CJMoney WHERE BatchNum = '" + key + "';";
                output += "\nSELECT * FROM TBL_ARtrans WHERE BatchNum = '" + key + "';";
                return output;
            }
            else
            {
                return " ";
            }
        }

        private void richTextBox1_TextChanged(object sender, EventArgs e)
        {

        }
    }
}


// Drag Form
        [DllImport("user32.DLL", EntryPoint = "ReleaseCapture")]
        private extern static void ReleaseCapture();
        [DllImport("user32.DLL", EntryPoint = "SendMessage")]
        private extern static void SendMessage(System.IntPtr hWnd, int wMsg, int wParam, int lParam);
        
        private void TopPanel_MouseDown(object sender, MouseEventArgs e)
        {
            ReleaseCapture();
            SendMessage(this.Handle, 0x112, 0xf012, 0);
        }
        
        // Close-Maximize-Minimize
        private void CloseIconButton_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        private void MaximizeIconButton_Click(object sender, EventArgs e)
        {
            if (WindowState == FormWindowState.Normal)
            {
                WindowState = FormWindowState.Maximized;
                FormBorderStyle = FormBorderStyle.None;
                MaximizeIconButton.IconChar = FontAwesome.Sharp.IconChar.WindowRestore;
            }
            else
            {
                WindowState = FormWindowState.Normal;
                MaximizeIconButton.IconChar = FontAwesome.Sharp.IconChar.Square;
            }
        }

        private void MinimizeIconButton_Click(object sender, EventArgs e)
        {
            WindowState = FormWindowState.Minimized;
        }